<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/head :: head"></head>
<body>

<header>
    <nav th:replace="fragments/navbar :: navbar"></nav>
</header>
<!--======================================================== user image and info =================================================-->
    <div class="container">

        <div class="media align-items-center py-3 mb-3">
            <img src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="" class="d-block ui-w-100 rounded-circle">
            <div class="media-body ">
                <h4 class="font-weight-bold mb-0"><span th:text="${currentUser.username}"></span></h4>
                <h4 class="font-weight-bold mb-2"><span class="text-muted font-weight-normal"><span
                        th:text="${currentUser.email}"></span></span></h4>
                <!--            <a href="#" class="btn btn-primary btn-sm">Edit</a>-->
                <!--            <a href="#" class="btn btn-default btn-sm">Profile</a>-->
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-body">
                <table class="table user-view-table m-0">
                    <tbody>

                    <form th:action="@{/profile/edit/{id}(id=${currentUser.id})}" method="post">
                        <tr>
                            <td>Edit Username:</td>
                            <td><input name="username" type="text" th:value="${currentUser.username}"></td>
                        </tr>

                        <tr>
                            <td>Edit E-mail:</td>
                            <td><input name="email" type="text" th:value="${currentUser.email}"></td>
                        </tr>

                        <tr>
                            <td>Please type in a new password or re-input your old password:</td>
                            <td><input name="password" type="text"></td>
                        </tr>

                        <tr>
                            <td>
                                <div class="form-group mt-2">
                                    <label for="profile-pic">Profile Picture:</label>
                                    <button id="profile-pic" type="button" class="btn btn-success" onclick="myFunction()">Upload</button>
                                    <span><i class="fa fa-check hidden" style="color:green"></i></span>
                                </div>
                            </td>
                        </tr>
                        <tr>
                        <input type="submit">
                        </tr>
                    </form>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <footer th:replace="fragments/footer :: footer"></footer>

<script>
    function myFunction() {
        console.log("I was clicked");

        const client = filestack.init(FileStackAPI);
        const options = {
            accept: ["image/*"],
            onUploadDone: (res) => {
                console.log(res);
                let handle = "https://www.filestackapi.com/api/file/" + res.filesUploaded[0].handle;

                if (handle !== null || handle !== "") {
                    $('.fa-check').toggleClass('hidden', 'visible');
                }

                document.getElementById('hidden').value = handle;
            }

        };

        client.picker(options).open();
    }
</script>
</body>
</html>