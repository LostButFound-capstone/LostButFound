<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head">

</head>
<body>
<!--Header fragment-->
<header>
	<!-- If NOT logged on -->
	<nav th:replace="fragments/navbar :: navbar" sec:authorize="!isAuthenticated()"></nav>
	<!-- If logged on -->
	<nav th:replace="fragments/new-navbar :: new-navbar" sec:authorize="isAuthenticated()"></nav>
</header>

<!--Main Container-->
<div style="background: -webkit-linear-gradient(280deg, hsla(166, 100%, 35%, 1) 10%, hsla(344, 84%, 60%, 1) 54%, hsla(31, 100%, 50%, 1) 90%);" class="container mt-5 no-gutters border">
	<br>
	<br>
	<h3 align="center">Find lost property:</h3>

<!--Listings form-->

		<form th:action="@{/listings}" method="get">

<!--Filter card-->
			<div class="container">
				<div class="row mb-2">
					<div class="col-sm-6 mr-2 card box-shadow align-items-center">
<!--Locations dropdown-->
							<label for="locations_dropdown">Locations:</label>
							<select id="locations_dropdown" data-selected="">
								<option  value="" selected="selected" disabled="disabled">Select a location</option>
								<th:block th:each="location : ${locations}">
									<option th:value="${location.id}"><span th:text="${location.location_name}"></span></option>
								</th:block>
							</select>
<!--Categories dropdown-->
							<label for="categories">Categories:</label>
							<select id="categories" data-selected="">
								<option value="null" selected="selected" disabled="disabled">Select a category:</option>
								<th:block th:each="category : ${categories}">
									<option th:value="${category.id}"><span th:text="${category.property_type}"></span></option>
								</th:block>
							</select>
<!--Date-picker-->
							<label for="dateFound">Date lost:</label>
							<input class="mb-2" id="dateFound" type="date" name="date_found">

<!--Filter button-->
							<button  type="button">Filter</button>
					</div>
					<div class="col sm-6 card">
						im a card
					</div>
				</div>
				<div class="row">
					<div class="images col card mb-3 box-shadow" data-selected="">
						<span class="loader">loading image...</span>
						<span class="no-selection">no location selected =)</span>
						<img src="img/san_antonio_airport.jpg" data-image="1" alt="San Antonio Airport" title="San Antonio Airport" />
						<img src="img/river_walk.jpg" data-image="2" alt="River Walk" title="River Walk" />
						<img src="img/the_alamo.jpg" data-image="3" alt="The Alamo" title="The Alamo" />
						<img src="img/north_star_mall.jpg" data-image="4" alt="North Star Mall" title="North Star Mall" />
<!--						<img src="src/main/resources/static/img/san_antonio_airport.jpg" data-image="5" alt="Workshop" title="Workshop" />-->
					</div>
				</div>
			</div>
		</form>

<!--Property Cards-->
			<div class="card py-5">
				<div class="container">
					<div class="row">
						<div class="row" th:each="item : ${properties}">
							<div class="card mb-3 box-shadow ">
								<div class="card-body">

									<p th:text="${item.title}"/></p>

									<p style="float: right;" th:text="${item.location.location_name}"></p>
									<p>Location found:</p>

									<p style="float: right;" th:text="${item.date_found}"></p>
									<p>Date Found:</p>

									<th:block th:each="category : ${item.categories}">
										<p style="float: right;" th:text="${category.property_type}"></p>
									</th:block>
									<p>Categories:</p>

									<a role="button" style="float: right" class="btn btn-sm btn-outline-secondary" th:href="@{/inquiry/{id}(id=${item.id})}">Inquire</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
<script>
    const selectbox = document.getElementById("locations_dropdown");
    const imagecontainer = document.querySelector(".images");
    let selection = selectbox.dataset.selected;

    selectbox.addEventListener("change", e => {
        selection = selectbox.value;
        imagecontainer.classList.add("loading");
        imagecontainer.dataset.selected = "";

        setTimeout(() => {
            imagecontainer.classList.remove("loading");
            imagecontainer.dataset.selected = selection;
        }, 1500);
    });
</script>
</body>

<!--Footer fragment-->
<footer th:replace="fragments/footer :: footer">
</footer>
</html>